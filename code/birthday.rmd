---
title: "Birthday Problem Simulation"
author: "Lucas Brizola Fontoura"
date: "08/2025"
output: 
  md_document:
    variant: gfm
enconding: UTF-8
---

# What is the Birthday Problem?
The Birthday Problem is a famous problem in probability theory that asks how likely it is that in a group of people, at least two will share the same birthday.
The problem is counterintuitive because it suggests that a relatively small group of people can have a high probability of sharing a birthday.

### The question is: How many people do you need in a room for there to be a better than even chance that at least two people share a birthday?

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Load necessary libraries
library(dplyr)
library(ggplot2)
```

```{r}
set.seed(42) # Set seed for reproducibility
verbose <- FALSE # Set to TRUE to see simulation details

# Number of simulation trials
# (the bigger, the closer to the theorethical probability)
tries <- 30
```

```{r}
results <- data.frame(
  people = integer(),
  probability = numeric()
)
```

```{r}
# Function to simulate one group
simulate_group <- function(n_people) {
  birthdays <- sample(1:365, n_people, replace = TRUE)

  if (verbose) {
    cat(
      "Simulating group of", n_people, "people with birthdays:", birthdays, "\n"
    )
  }

  length(unique(birthdays)) < length(birthdays)
}
```

```{r}
# Loop for 2 to 50 people
for (n_people in 2:50) {
  same_birthday <- sum(replicate(tries, simulate_group(n_people = n_people)))
  probability <- same_birthday / tries
  results <- rbind(
    results,
    data.frame(people = n_people, probability = probability)
  )

  cat(
    "For", n_people, "people, the simulated probability of shared birthday is",
    round(probability, 4), "\n"
  )
}
```

```{r}
# Theorethical probability function
theorethical_probability <- function(n_people) {
  1 - prod((365:(365 - n_people + 1)) / 365)
}
```

```{r}
results <- results %>%
  mutate(theorethical_probability = sapply(people, theorethical_probability))
```

```{r}
# Plotting the results
ggplot(results, aes(x = people)) +
  geom_line(
    aes(y = probability, color = "Simulated Probability"),
    linewidth = 1.2
  ) +
  geom_point(aes(y = probability, color = "Simulated Probability")) +
  geom_line(
    aes(y = theorethical_probability, color = "Theorethical Probability"),
    linetype = "dashed",
    linewidth = 1
  ) +
  geom_vline(xintercept = 23, linetype = "dotted", color = "red") +
  annotate(
    "text",
    x = 23,
    y = 0.55,
    label = "~50% at 23 people",
    color = "red",
    vjust = -0.5
  ) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Birthday Problem Simulation",
    subtitle = paste(
      "Simulation vs. Theory (", tries, " trials each)",
      sep = ""
    ),
    x = "Number of People",
    y = "Probability of Shared Birthday",
    color = "Legend"
  ) +
  theme_minimal()
```

# Conclusion

The simulation shows that as the number of people in a group increases, the probability of at least two people sharing a birthday also increases significantly.
In fact, with just 23 people, there is over a 50% chance that at least two people share a birthday.
This counterintuitive result highlights the surprising nature of probability and how our intuition can often lead us astray.