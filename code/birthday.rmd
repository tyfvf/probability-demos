---
title: "Birthday Problem Simulation"
author: "Lucas Brizola Fontoura"
date: "08/2025"
output: 
  md_document:
    variant: gfm
enconding: UTF-8
---

# The Birthday Problem Simulation

## Introduction

The **Birthday Problem** asks:

> In a group of \(n\) people, what is the probability that at least two of them share the same birthday?

Surprisingly, this probability reaches **over 50%** with just 23 people â€” far less than most people expect.  
Here, we'll explore both the *theorethical* calculation and a *simulation-based* approach.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Load necessary libraries
library(dplyr)
library(ggplot2)
```

## Parameters - Try changing them!

You can tweak these variables to see how the results change:

```{r, setup}
max_people <- 60  # Maximum group size to simulate
tries <- 1000     # Number of simulation trials per group size
verbose <- FALSE  # Set to TRUE to see simulation details
set.seed(42)      # Set seed for reproducibility
```

## Simulation approach
The idea:

1. Randomly assign birthdays (1-365) to n people.
2. Check if any birthday appears more than once.
3. Repeat many times to estimate the probability.

```{r}
results <- data.frame(
  people = integer(),
  probability = numeric()
)
```

```{r}
# Function to simulate one group
simulate_group <- function(n_people) {
  birthdays <- sample(1:365, n_people, replace = TRUE) # 1.

  if (verbose) {
    cat(
      "Simulating group of", n_people, "people with birthdays:", birthdays, "\n"
    )
  }

  length(unique(birthdays)) < length(birthdays) # 2.
}
```

```{r}
for (n_people in 2:max_people) { # 3.
  same_birthday <- sum(replicate(tries, simulate_group(n_people = n_people)))
  probability <- same_birthday / tries
  results <- rbind(
    results,
    data.frame(people = n_people, probability = probability)
  )

  cat(
    "For", n_people, "people, the simulated probability of shared birthday is",
    round(probability, 4), "\n"
  )
}
```

## Theorethical approach
Mathematically, the probability that **no one** shares a birthday is:
\[P_{\text{no shared birthday}}(n) = \frac{365}{365} \times \frac{364}{365} \times \frac{363}{365} \times \ldots \times \frac{365 - n + 1}{365}\]
Thus, the probability that **at least two people share a birthday** is:
\[P_{\text{at least one shared birthday}}(n) = 1 - P_{\text{no shared birthday}}(n)\]

```{r}
# Theorethical probability function
theorethical_probability <- function(n_people) {
  1 - prod((365:(365 - n_people + 1)) / 365)
}
```

```{r}
results <- results %>%
  mutate(theorethical_probability = sapply(people, theorethical_probability))
```

## Comparing Simulation & Theory

```{r}
ggplot(results, aes(x = people)) +
  geom_line(
    aes(y = probability, color = "Simulated Probability"),
    linewidth = 1.2
  ) +
  geom_point(aes(y = probability, color = "Simulated Probability")) +
  geom_line(
    aes(y = theorethical_probability, color = "Theorethical Probability"),
    linetype = "dashed",
    linewidth = 1
  ) +
  geom_vline(xintercept = 23, linetype = "dotted", color = "red") +
  annotate(
    "text",
    x = 23,
    y = 0.55,
    label = "~50% at 23 people",
    color = "red",
    vjust = -0.5
  ) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Birthday Problem Simulation",
    subtitle = paste(
      "Simulation vs. Theory (", tries, " trials each)",
      sep = ""
    ),
    x = "Number of People",
    y = "Probability of Shared Birthday",
    color = "Legend"
  ) +
  theme_minimal()
```

## Results & Insights
- Both methods agree closely, especially as the number of trials increases.
- The simulation adds randomness, so results may vary slightly each run.
- Even with **23 people**, the probability exceeds **50%**.
- By 60 people, the probability is above **99%**

## Conclusion

The Birthday Problem is a great example of counterintuitive probability.
Simulations like this help us verify theoretical results and build intuition for probability concepts.